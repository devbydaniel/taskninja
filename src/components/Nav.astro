---
import Button from "./Button.astro";

interface Props {
  projects: string[];
}

const { projects } = Astro.props;

const { report: reportParam } = Astro.params;
const REPORTS = ["next", "ready", "list", "blocked", "blocking", "waiting"];
---

<div class="nav">
  <div class="nav__new-task-button">
    <Button block>Add Task</Button>
  </div>
  <h2 class="nav__title">Reports</h2>
  <ul class="nav__list">
    {
      REPORTS.map((report) => (
        <a
          href={`/reports/${report}`}
          class:list={[
            "nav__list__item",
            { "nav__list__item--active": reportParam === report },
          ]}
        >
          {report}
        </a>
      ))
    }
  </ul>
  <h2 class="nav__title">Projects</h2>
  <ul class="nav__list">
    <a href="/projects/null" class="nav__list__item">w/o project</a>
    {
      projects.map((project) => (
        <a href={`/projects/${project}`} class="nav__list__item">
          {project}
        </a>
      ))
    }
  </ul>
</div>

<style>
  .nav {
    padding: var(--gap-md);
    background: var(--background-raised);
    height: 100%;
    border-right: var(--border-width) solid var(--border-color);
  }
  .nav__new-task-button {
    margin-bottom: var(--gap-md);
  }
  .nav__title {
    padding: var(--gap-sm);
    font-weight: bold;
    color: var(--color-text-muted);
    font-size: var(--font-size-sm);
    margin-bottom: var(--gap-xs);
  }
  .nav__list {
    list-style: none;
    padding: 0;
    margin: 0;
    margin-bottom: var(--gap-md);
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }
  .nav__list__item {
    text-align: left;
    border: none;
    padding: var(--gap-sm) var(--gap-md);
    cursor: pointer;
    text-decoration: none;
    color: var(--color-text);
    border-radius: var(--border-radius);
    transitions: background 0.3s ease;
  }
  .nav__list__item:hover {
    background: var(--background-focus);
  }
  .nav__list__item:active {
    background: var(--background-clicked);
  }
  .nav__list__item--active {
    background: var(--background-raised);
  }
  .nav__separator {
    border: none;
    border-top: 0.5px solid var(--color-text-muted);
    margin: 1rem 0;
  }
</style>

<script>
  import { newTaskModal } from "../lib/customEvents";

  const newTaskButton = document.querySelector(".nav__new-task-button")!;

  newTaskButton.addEventListener("click", () => {
    newTaskModal.trigger();
  });
</script>
